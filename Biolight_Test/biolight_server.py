# -*- coding: utf-8 -*-from flask import Flask, request, render_templateimport sqlite3from datetime import datetimeapp = Flask(__name__)DB_FILE = "database.db"# Création de la table si elle n'existe pasconn = sqlite3.connect(DB_FILE)c = conn.cursor()c.execute('''CREATE TABLE IF NOT EXISTS mesures (                id INTEGER PRIMARY KEY AUTOINCREMENT,                timestamp TEXT,                temperature_air REAL,                humidity REAL,                temperature_eau REAL,                luminosity INTEGER,                mouvement INTEGER,                distance REAL,                soil_moisture INTEGER,                water_level INTEGER,                turbidity INTEGER,                gas_level INTEGER,                voltage REAL,                current REAL,                power REAL            )''')conn.commit()conn.close()# Route pour afficher le dashboard@app.route('/')def index():    conn = sqlite3.connect(DB_FILE)    c = conn.cursor()    c.execute("SELECT * FROM mesures ORDER BY id DESC LIMIT 20")    data = c.fetchall()    conn.close()    return render_template("index.html", data=data)# Route pour recevoir les données des capteurs@app.route('/update', methods=['POST'])def update():    data = request.get_json()    conn = sqlite3.connect(DB_FILE)    c = conn.cursor()    c.execute('''INSERT INTO mesures                  (timestamp, temperature_air, humidity, temperature_eau, luminosity, mouvement,                  distance, soil_moisture, water_level, turbidity, gas_level, voltage, current, power)                  VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)''',              (datetime.now().strftime("%Y-%m-%d %H:%M:%S"),               data.get("temperature_air"),               data.get("humidity"),               data.get("temperature_eau"),               data.get("luminosity"),               data.get("mouvement"),               data.get("distance"),               data.get("soil_moisture"),               data.get("water_level"),               data.get("turbidity"),               data.get("gas_level"),               data.get("voltage"),               data.get("current"),               data.get("power")))    conn.commit()    conn.close()    return "OK", 200# Lancer le serveur Flaskif __name__ == '__main__':    app.run(host='0.0.0.0', port=5000)